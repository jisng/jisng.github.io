<!DOCTYPE html>
<html lang="en">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="description" content="">
  <meta name="author" content="jisng">
  <meta name="keywords" content="swift, iOS, git, dev">
  <title>Struct ~ jisng</title>

  <link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"  >
<link rel="stylesheet" href="/lib/bootstrap/css/bootstrap.min.css"  >
<link rel="stylesheet" href="/lib/mdbootstrap/css/mdb.min.css"  >
<link rel="stylesheet" href="/lib/github-markdown/github-markdown.min.css"  >
<link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css">


  <link rel="stylesheet" href="/lib/prettify/tomorrow-night-eighties.min.css"  >

<link rel="stylesheet" href="/css/main.css"  >


  <link rel="stylesheet" href="/lib/fancybox/jquery.fancybox.min.css"  >


</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>jisng</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">Home</a>
          </li>
        
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">Archives</a>
          </li>
        
          
          
          <li class="nav-item">
            <a class="nav-link" href="/Categories/">Categories</a>
          </li>
        
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">Tags</a>
          </li>
        
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">About</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>


</nav>

    <div class="view intro-2" id="background"
         style="background: url('/img/default.png')no-repeat center center;
           background-size: cover;
           background-attachment: fixed;">
      <div class="full-bg-img">
        <div class="mask rgba-black-light flex-center">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              <br>
              
                <p class="mt-3">
                  <i class="fas fa-calendar-alt" aria-hidden="true"></i>&nbsp;
                  Monday, December 9th 2019, 7:51 pm
                </p>
              

              <p>
                
                  
                  &nbsp;<i class="far fa-chart-bar"></i>
                  <span class="post-count">
                    679 words
                  </span>&nbsp;
                

                
                  
                  &nbsp;<i class="far fa-clock"></i>
                  <span class="post-count">
                      4 times
                  </span>&nbsp;
                

                
                  <!-- 不蒜子统计文章PV -->
                  
                  &nbsp;<i class="far fa-eye" aria-hidden="true"></i>&nbsp;
                  <span id="busuanzi_container_page_pv">
                    <span id="busuanzi_value_page_pv"></span> views
                  </span>&nbsp;
                
              </p>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="py-5 z-depth-3" id="board">
        <div class="post-content mx-auto" id="post">
          <div class="markdown-body">
            <h1 id="Struct"><a href="#Struct" class="headerlink" title="Struct"></a>Struct</h1><h2 id="Comparing-Structures-and-Classes"><a href="#Comparing-Structures-and-Classes" class="headerlink" title="Comparing Structures and Classes"></a>Comparing Structures and Classes</h2><h3 id="클래스와-구조체-공통점"><a href="#클래스와-구조체-공통점" class="headerlink" title="클래스와 구조체 공통점"></a>클래스와 구조체 공통점</h3><ul>
<li><p>값을 저장하기 위한 프로퍼티</p>
</li>
<li><p>기능을 제공하기 위한 메서드</p>
</li>
<li><p>초기 상태를 설정하기 위한 생성자</p>
</li>
<li><p>기본 구현에서 기능을 추가하기 위한 확장(Extension)</p>
</li>
<li><p>특정 값에 접근할 수 있는 첨자(Subscript)</p>
</li>
<li><p>특정한 기능을 수행하기 위한 프로토콜 채택</p>
</li>
<li><p>Upper Camel Case 사용</p>
</li>
</ul>
<h4 id="클래스만-제공하는-기능"><a href="#클래스만-제공하는-기능" class="headerlink" title="클래스만 제공하는 기능"></a>클래스만 제공하는 기능</h4><ul>
<li><p>상속 (Inheritance)</p>
</li>
<li><p>소멸자 (Deinitializer) -  deinit 메서드</p>
</li>
<li><p>참조 카운트 (Reference counting)</p>
</li>
</ul>
<h3 id="값-타입-Vs-참조-타입"><a href="#값-타입-Vs-참조-타입" class="headerlink" title="값 타입 Vs 참조 타입"></a>값 타입 Vs 참조 타입</h3><pre><code class="swift">class Dog {
  var name = &quot;똘똘이&quot;
}
struct Cat {
  var name = &quot;애옹이&quot;
}

let dog = Dog()
let cat = Cat()

dog.name = &quot;똘똘이2&quot; // 가능
cat.name = &quot;애옹이2&quot; // 에러 : Stack, 값참조, 접근 불가

let cat1 = cat

cat === cat1 // 사용불가, 값타입으로 해당 연산자 사용 불가</code></pre>
<h3 id="생성자-비교"><a href="#생성자-비교" class="headerlink" title="생성자 비교"></a>생성자 비교</h3><table>
<thead>
<tr>
<th></th>
<th>구조체</th>
<th>클래스</th>
</tr>
</thead>
<tbody><tr>
<td>초기화</td>
<td>필수</td>
<td>자동 생성</td>
</tr>
<tr>
<td>일부만 초기화</td>
<td>나머지 필수 초기화</td>
<td>나머지 자동 초기화</td>
</tr>
<tr>
<td>편의 생성자</td>
<td>사용 가능</td>
<td>지정 생성자와 <br>별도 구분 없이 사용</td>
</tr>
</tbody></table>
<h3 id="프로퍼티-변경"><a href="#프로퍼티-변경" class="headerlink" title="프로퍼티 변경"></a>프로퍼티 변경</h3><pre><code class="swift">struct PointStruct {
  var x = 0

 mutating func updateX() {  // 값 타입은 mutating 붙여줘야 한다 / enum, struct
    self.x = 5
  }

  var updateProperty: Int {  // 연산프로퍼티는 사용 안해도 된다
    get { x }
    set { x = newValue }    // 연산 프로퍼티의 setter는 기본적으로 mutating
  }
}


let p2 = PointStruct()
p2.updateX() // error : constant
p2.updateProperty = 3 // error : constant
p2.updateProperty // 0

var p3 = PointStruct()
p3.updateX() // 
p3.x // 5
p3.updateProperty = 3
p3.updateProperty // 3
</code></pre>
<h3 id="프로토콜-적용"><a href="#프로토콜-적용" class="headerlink" title="프로토콜 적용"></a>프로토콜 적용</h3><pre><code class="swift">protocol Mutate {
  mutating func update() // struct 에서 mutating 을 사용하고 싶으면, 프로토콜에서부터 ...
}

struct PointStruct1: Mutate {
  var x = 0

  mutating func update() {
    self.x = 5
  }
}</code></pre>
<hr>
<h1 id="ARC"><a href="#ARC" class="headerlink" title="ARC"></a>ARC</h1><h2 id="Memory-Management"><a href="#Memory-Management" class="headerlink" title="Memory Management"></a>Memory Management</h2><p>다른 언어에서는 다음과 같은 방식들로 메모리 관리를 한다.</p>
<ul>
<li>GC(Garbage Collection)</li>
<li>MRR(Manual Retain-Release) / MRC(Manual Reference Counting)</li>
</ul>
<p>메모리 문제</p>
<ul>
<li>Memory Leak : 더 이상 사용하지 않는 메모리들이 많음</li>
<li>Dangling Pointer : 찾아야 하는데 찾을 수 없는 허상 메모리들이 생김</li>
</ul>
<h2 id="ARC-Automatic-Reference-Counting"><a href="#ARC-Automatic-Reference-Counting" class="headerlink" title="ARC - Automatic Reference Counting"></a>ARC - Automatic Reference Counting</h2><ul>
<li>컴파일러가 개발자를 대신하여 메모리 관리 코드를 적절한 위치에 자동으로 삽입</li>
<li>컴파일 단에서 처리 (Heap 에 대한 스캔 불필요 / 앱 일시 정시 현상 없음)</li>
<li>메모리 관리 이슈를 줄이고 개발자가 코딩 자체에 집중할 수 있도록 함</li>
</ul>
<h3 id="적용"><a href="#적용" class="headerlink" title="적용"></a>적용</h3><ul>
<li><p>ARC는 클래스의 인스턴스에만 적용 (Class - Reference타입, Struct / Enum - Value 타입)</p>
</li>
<li><p>활성화된 참조카운트가 하나라도 있을 경우 메모리에서 해제 되지 않는다.</p>
</li>
</ul>
<ul>
<li>참조 타입<ul>
<li>강한 참조 (Strong): 기본값, 참조될 때마다 참조 카운트 1 증가</li>
<li>약한 참조 (Weak), 미소유 참조(Unowned): 참조 카운트를 증가시키지 않음</li>
<li><strong>주의 !!</strong> 강한 순환 참조 (Strong Reference Cycles) </li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th align="center">var</th>
<th align="center">let</th>
<th align="center">Optional</th>
<th align="center">Non-Optional</th>
</tr>
</thead>
<tbody><tr>
<td>strong</td>
<td align="center">⭕️</td>
<td align="center">⭕️</td>
<td align="center">⭕️</td>
<td align="center">⭕️</td>
</tr>
<tr>
<td>weak</td>
<td align="center">⭕️</td>
<td align="center">❌</td>
<td align="center">⭕️</td>
<td align="center">❌</td>
</tr>
<tr>
<td>unowned</td>
<td align="center">⭕️</td>
<td align="center">⭕️</td>
<td align="center">❌</td>
<td align="center">⭕️</td>
</tr>
</tbody></table>
<h4 id="ARC-in-Class"><a href="#ARC-in-Class" class="headerlink" title="ARC in Class"></a>ARC in Class</h4><p><video src="struct-til-191209/classReferenceCounting.mov"></video></p>
<h4 id="ARC-in-Struct"><a href="#ARC-in-Struct" class="headerlink" title="ARC in Struct"></a>ARC in Struct</h4><p><video src="struct-til-191209/structReferenceCounting.mov"></video></p>
<h4 id="Strong-Reference-Cycle"><a href="#Strong-Reference-Cycle" class="headerlink" title="Strong Reference Cycle"></a>Strong Reference Cycle</h4><ul>
<li>객체에 접근 가능한 모든 연결을 끊었음에도 순환 참조로 인해 활성화된 참조 카운트가 남아 있어 메모리 누수가 발생</li>
<li>앱의 실행이 느려지거나 오동작 또는 오류를 발생시키는 원인</li>
</ul>
<p><video src="struct-til-191209/StrongReference.mov"></video></p>
<h4 id="Weak-Reference"><a href="#Weak-Reference" class="headerlink" title="Weak Reference"></a>Weak Reference</h4><p><video src="struct-til-191209/WeakReference.mov"></video></p>
<h4 id="strong-vs-weak-vs-unowned"><a href="#strong-vs-weak-vs-unowned" class="headerlink" title="strong vs. weak vs. unowned"></a>strong vs. weak vs. unowned</h4><table>
<thead>
<tr>
<th></th>
<th>strong</th>
<th>weak</th>
<th>unowned</th>
</tr>
</thead>
<tbody><tr>
<td>-</td>
<td>기본값</td>
<td></td>
<td></td>
</tr>
<tr>
<td>참조</td>
<td>강한 참조</td>
<td>약한 참조</td>
<td>미소유 참조</td>
</tr>
<tr>
<td>Count</td>
<td>Reference Count + 1</td>
<td>참조하던 객체 해제 시 <br>nil값으로 변경</td>
<td>참조 객체 해제 시에도 <br>기존 포인터 주소 유지</td>
</tr>
<tr>
<td>nil</td>
<td>명시적으로 대입</td>
<td>자동 deinit <br>nil 처리 된 속성에 접근하면 nil 반환</td>
<td>자동 deinit <br> nil 처리 된 속성에 접근하면 nil 반환</td>
</tr>
</tbody></table>
<pre><code class="swift">class Person {
  let testCase: String
  init(testCase: String) {
    self.testCase = testCase
  }
  deinit {
    print(&quot;\(testCase) is being deinitialized&quot;)
  }
}

var strongObj4 = Person(testCase: &quot;case4&quot;)
print(strongObj4)

weak var weakObj4 = Person(testCase: &quot;case4&quot;)
print(weakObj4)

unowned var unownedObj4 = Person(testCase: &quot;case4&quot;) // count 0 -&gt; unowned (카운터 증가시키지 않음) =&gt; 사라짐
print(unownedObj4) // 사라진 주소값에 접근하므로 오류</code></pre>
<h2 id="Scope"><a href="#Scope" class="headerlink" title="Scope"></a>Scope</h2><pre><code class="swift">class LocalScope {
  func doSomething() {}
  deinit {
    print(&quot;LocalScope is being deinitialized&quot;)
  }
}

class ClassProperty {
  func doSomething() {}
  deinit {
    print(&quot;ClassProperty is being deinitialized&quot;)
  }
}

class Application {
  var prop = ClassProperty()

  func allocateInstance() {
    let local = LocalScope()
    local.doSomething()
  }

  deinit {
    print(&quot;Application is being deinitialized&quot;)
  }
}


// Q. 아래의 코드 실행 시 출력되는 메시지는?

var app: Application? = Application()
app?.prop.doSomething()
app?.allocateInstance() // &quot;LocalScope is being deinitialized&quot;



// Q. ClassProperty 객체의 deinit 메서드가 호출되려면 어떻게 할까요?
app = nil
</code></pre>
<h2 id="Strong-Reference-Cycles"><a href="#Strong-Reference-Cycles" class="headerlink" title="Strong Reference Cycles"></a>Strong Reference Cycles</h2><pre><code class="swift">// 강한순환참조발생

class Person {
  var pet: Dog?
  func doSomething() {}
  deinit {
    print(&quot;Person is being deinitialized&quot;)
  }
}

class Dog {
  var owner: Person?
  func doSomething() {}
  deinit {
    print(&quot;Dog is being deinitialized&quot;)
  }
}



var me: Person? = Person() // count 1
var viva: Dog? = Dog() // count 1

me?.pet = viva // count2
viva?.owner = me // count2

me?.doSomething()
viva?.doSomething()

//me = nil // person count = 1
//viva = nil // person count = 1
// 메모리 누수


// 순서 주의

me?.pet = nil
viva?.owner = nil

me = nil
viva = nil</code></pre>

            <hr>
          </div>
          <br>
          <div>
            <p>
            
              <span>
                <i class="iconfont icon-inbox"></i>
                
                  <a class="hover-with-bg" href="/categories/TIL">TIL</a>
                  &nbsp;
                
              </span>&nbsp;&nbsp;
            
            
              <span>
                <i class="iconfont icon-tag"></i>
                
                  <a class="hover-with-bg" href="/tags/iOS">iOS</a>
                
                  <a class="hover-with-bg" href="/tags/swift">swift</a>
                
                  <a class="hover-with-bg" href="/tags/sturct">sturct</a>
                
                  <a class="hover-with-bg" href="/tags/ARC">ARC</a>
                
              </span>
            
            </p>
            
          </div>
        </div>
      </div>
    </div>
    <div class="d-none d-lg-block col-lg-2 toc-container">
      
  <div id="toc">
    <p class="h4"><i class="far fa-list-alt"></i>&nbsp;TOC</p>
    <div id="tocbot"></div>
  </div>

    </div>
  </div>
</div>

<!-- custom -->


<!-- Comments -->
<div class="col-lg-7 mx-auto nopadding-md">
  <div class="container comments mx-auto" id="comments">
    
  </div>
</div>

    
  </main>

  
    <a class="z-depth-1" id="scroll-top-button" href="#" role="button">
      <i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  <footer class="mt-5">
  <div class="text-center py-3">
    <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><b>Hexo</b></a>
    <i class="iconfont icon-love"></i>
    <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"> <b>Fluid</b></a>
    <br>

    
  
    <!-- 不蒜子统计PV -->
    
    &nbsp;<span id="busuanzi_container_site_pv">총방문횟수 
          <span id="busuanzi_value_site_pv"></span> 번</span>&nbsp;
  
  
    <!-- 不蒜子统计UV -->
    
    &nbsp;<span id="busuanzi_container_site_uv">총방문객 
            <span id="busuanzi_value_site_uv"></span> 명</span>&nbsp;
  
  <br>



    

  </div>
</footer>

<!-- SCRIPTS -->
<script src="/lib/jquery/jquery.min.js" ></script>
<script src="/lib/popper/popper.min.js" ></script>
<script src="/lib/bootstrap/js/bootstrap.min.js" ></script>
<script src="/lib/mdbootstrap/js/mdb.min.js" ></script>
<script src="/js/main.js" ></script>


  <script src="/js/lazyload.js" ></script>



  
    <script src="/lib/tocbot/tocbot.min.js" ></script>
  
  <script src="/js/post.js" ></script>



  <script src="/lib/smooth-scroll/smooth-scroll.min.js" ></script>



  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>


<!-- Plugins -->


  

  

  

  

  




  <script src="/lib/prettify/prettify.min.js" ></script>
  <script>
    $(document).ready(function () {
      $('pre').addClass('prettyprint  linenums');
      prettyPrint();
    })
  </script>



  <script src="/lib/typed/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "Struct&nbsp;",
      ],
      cursorChar: " : JISNG",
      typeSpeed: 100,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script src="/lib/anchor/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "false",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>



  <script src="/lib/fancybox/jquery.fancybox.min.js" ></script>
  <script>
    $("#post img:not(.no-zoom img, img[no-zoom])").each(
      function () {
        var element = document.createElement("a");
        $(element).attr("data-fancybox", "images");
        $(element).attr("href", $(this).attr("src"));
        $(this).wrap(element);
      }
    );
  </script>







</body>
</html>
